# 迭代器和生成器
## 可迭代对象
1. 迭代的引入
> 使用`for i in xxx`对字符串、列表、元组、字典、集合进行循环取值的过程称为遍历，也叫迭代
```python
li = [1,2,3,'a','b','c']
for i in li:
    print(i)

str = "hello,world"
for j in str:
    print(j)

dic = {'name':'yc','age':18,'job':'teacher'}
for k,v in dic.items():
    print(k,v)

"""
输出
>>> li = [1,2,3,'a','b','c']
>>> for i in li:
...     print(i)
... 
1
2
3
a
b
c
>>> str = "hello,world"
for j in str:
...     print(j)
... 
h
e
l
l
o
,
w
o
r
l
d
dic = {'name':'yc','age':18,'job':'teacher'}
for k,v in dic.items():
...     print(k,v)
... 
name yc
age 18
job teacher
"""
```

### 可迭代对象的定义
> 可迭代对象是指能够通过迭代逐一返回其元素的对象
满足条件：
    - 实现`__iter__()`方法，返回一个可迭代对戏那个
    - 实现`__getitem__()`方法，支持从索引0开始的顺序访问

#### 示例 判断是否为可迭代对象
```python
from collections.abc import Iterable

list = [1,2,3,4]
temple = (1,2,3,4)
dict = {1:2,3:4,5:6}
set = {1,2,3,4}
a = 100

print(isinstance(list,Iterable))
print(isinstance(temple,Iterable))
print(isinstance(dict,Iterable))
print(isinstance(set,Iterable))
print(isinstance(a,Iterable))

"""
输出
from collections.abc import Iterable
list = [1,2,3,4]
tumple = (1,2,3,4)
dict = {1:2,3:4,5:6}
set = {1,2,3,4}
a = 100
print(isinstance(list,Iterable))      # 列表可迭代
True 
print(isinstance(tumple,Iterable))    # 元组可迭代
True
print(isinstance(dict,Iterable))      # 字典可迭代
True
print(isinstance(set,Iterable))       # 集合可迭代
True
print(isinstance(a,Iterable))         # 整数不可迭代
False
"""
```
### 迭代器
1. 概览
> 1. 迭代器是一种用于遍历可迭代对象的对象，可以记录遍历的位置
> 2. 通过`__iter__`方法返回一个迭代器，迭代一个可迭代对象的时候，实际上是先获取该对象提供的一个迭代器，然后通过这个迭代器依次获取获取对象中的每一个数据
> 3. 迭代是访问集合的一种方式，迭代器是一个可以记住遍历的位置的对象；迭代器对象从集合的第一个元素开始访问，直到所有的元素被访问完结束（即迭代器只会往前而不会后退）
```
list = [1,2,3,4]
tuple = (1,2,3,4)
dict = {1:2,3:4}
set = {1,2,3,4}

print(dir(list))
print(dir(tuple))
print(dir(dict))
print(dir(set))
```
#### 迭代器本质
>我们分析对可迭代对象进行迭代的过程，发现每迭代一次（即在`for...in`循环中每循环一次）都会返回对象中的下一条数据，一直向后读取数据知道迭代了所有数据后结束  
>在这个过程中，就有一个对象去记录每次访问到了第几条数据，以便每次迭代都可以返回下一条数据，这个扮演数据迭代的对象称为**迭代器**
#### 迭代器协议
> 迭代器遵循迭代协议，内部主要定义了`__iter__()`和`__next__()`两个方法
> - `__iter__()`方法用于初始化一个迭代器，返回迭代器本身
> - `__next__()`方法用于迭代下一个数据。当没有元素可返回时，抛出`StopIteration`异常
#### 初始化迭代器
```
# 3.1 初始化迭代器
list1 = [1,2,3,'a','b','c']
list_iter = list1.__iter__()
item = list_iter.__next__()
print(item)                # 输出 1
item = list_iter.__next__()
print(item)                # 输出 2
item = list_iter.__next__()
print(item)                # 输出 3
item = list_iter.__next__()
print(item)                # 输出 a
item = list_iter.__next__()
print(item)                # 输出 b
item = list_iter.__next__()
print(item)                # 输出 c
item = list_iter.__next__()
print(item)               # 报错，抛出`StopIteration异常`

# 3.2 初始化迭代器（写法2）
list2 = [1,2,3,'a','b','c']

list_iter = list2.__iter__()
while True:
    try:
        print(next(list_iter))
    except StopIteration:
        print("迭代结束")
        break
```
#### 判断对象是否为迭代器的方法
> 使用内置的`isinstance()`方法来判断某个对象是否是迭代器对象
```
from collections.abc import Iterator
list3 = [1,2,3,'a','b','c']

list_iter = list3.__iter__()

print(isinstance(list1,Iterator))           # 输出 False，list1非迭代器
print(isinstance(list_iter,Iterator))       # 输出True，list_iter为迭代器
print(isinstance(iter(list3),Iterator))     # 输出True，iter()函数返回迭代器
```