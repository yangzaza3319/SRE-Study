## python装饰器
> 在不修改函数代码的情况下，动态的修改函数(或方法)的行为，装饰器本质上是一个函数，它接受函数作为参数并返回一个新的函数
应用场景：插入日志、性能测试、事务处理以及缓存等场景

### 案例切入
> 有一个函数``func1()`，作用是输出一段话。我们需要给他增加额外的功能，但不改变原函数

```python
def func1():
    print("在func1()中")

""" 
需求：打印下列内容
hello world
in function1
hello python
"""

# 案例实现
def func2(func):
    def inner():
        print("hello world")
        func()
        print("hello python")
    return inner
func1 = func2(func1)
func1()

```

### 装饰器形成的过程
> 语法糖
> python中的语法糖结构，用于更简便的使用装饰器

```python
# 测试某个函数的执行时间
# 原有代码
import time

def func1():
    print('in func1')

def timer(func):
    def inner():
        start = time.time()
        func()
        print(time.time() - start)
    return inner()

func1 = timer(func1)  # 将dunc1()函数作为参数传出去
func1()

"""
输出
in func1
1.2874603271484375e-05
"""
```
> 使用语法糖来更简便的使用装饰器:
当我们在某个函数上方使用@my_decorator 的时候，python会自动将下面定义的函数作为参数传递给@my_decorator，即func1 = timer(func1)
```
import time

def timer(func):
    def innner():
        start = time.time()
        func()
        print(time.time() -start)
    return innner
@timer
def func2():
    time.sleep(1)
    print('in func2')
func2()
"""
调试结果
显式执行func2()函数
    ——>输出
    in func2
    1.0043830871582031
"""
```

### 修饰带一个参数的函数
> 与装饰不带参数的函数类似，但需要在装饰器中处理传递给被装饰函数的参数

####  例子
```
import time

def timer(func):
    def inner(a):
        start = time.time()
        func(a)
        print(time.time() - start)
    return inner

@timer
def func3(a):
    time.sleep(1)
    print(a)
func3("hello_world")

"""
输出
hello_world
1.0029830932617188
"""
```

### 装饰带多个参数的函数
> 利用动态参数进行传参
```
def my_decorator(func):
    def wrapper(*args,**kwargs):
        print(f"调用{func.__name__}函数返回：位置参数：{args}，关键字参数：{kwargs}") # 打印调用的函数、传入的参数（此处没有用到关键字参数，所以打印的kwargs参数为空）
        result = func(*args,**kwargs)                                       # 调用原始函数并获取结果
        print(f"{func.__name__}函数返回：{result}")                           # 打印返回结果
        return result
    return wrapper

@my_decorator
def add(x,y):
    return x + y

result = add(3,4)
print(f"最终结果：{result}")
"""
    输出结果
调用add函数返回：参数：(3, 4)，关键字参数：{}
add函数返回：7
最终结果：7
"""
```
### wraps装饰器
> 回顾最开始的案例
```
import time
def func1():
    print('in func1')

def timer(func):
    def inner():
        start = time.time()
        func()
        print(time.time() - start)
    return inner
func1 = timer(func1) # 将函数本身作为参数传递进去
func1()
```
> 问题1——>最后执行的`func1`函数和最初的`func1`是否为同一个函数?

```
#问题1 解法：打印函数名

import time
def func1():
    print('in func1')

def timer(func):
    def inner():
        start = time.time()
        func()
        print(time.time() - start)
    return inner
func1 = timer(func1)
print(func1.__name__)
"""
输出
inner
"""
```

